# GPT to aid TDD
Simple project to explore how good GPT is in generating tests for Python code. At the moment, completion
API is used in the project, in the future example may be extended with Codex (or not - if I will be to lazy 
:sweat_smile:).

## How the tool works?
The tool is simple library to generate boilerplate for Python code in pytest - main contribution of the 
tool is experimentation with ChatGPT prompt to generate meaningful scratches of test to speed up 
checking quality of the code.

## Installation
```bash
pip install git+https://github.com/PawelPeczek/GPTToAidTDD.git
```
## Usage example

### Prerequisites
To use the tool - you must create [OpenAI API](https://openai.com/api/) account and then export API key in environment
variable:
```bash
export OPENAI_API_KEY=<your_api_key>
```

### How to generate tests?
```python
from gpt_tester import generate_tests

result = generate_tests(
    tested_function_signature="def remove_empty(sequence: List[Optional[T]]) -> List[T]",
    tested_function_description="function is meant to remove None values from sequence and return filtered sequence as list in the original order",
    test_cases=[
        "empty list given", 
        "non empty list with only empty values given", 
        "non empty list with both empty and non empty values given", 
        "non empty list with only non empty values given"
    ],
    tests_specifics=["gwt", "stc", "typing"]
)

print(result)
```

Point out that:
* you may pass parameter `completion_config` to configure OpenAI model call at will (you may pass any
key denoted [in API reference](https://beta.openai.com/docs/api-reference/completions/create) apart from
`prompt` which will be generated by library)
* `tests_specifics` can be either full description of requirements in natural language, or predefined tags

#### Predefined tags to be used in `tests_specifics`
* `gwt` - enforce `given-when-then` convention
* `stc` - separate test cases to specific functions (and not use `pytest.mark.parametrize()`)
* `fixtures` - use fixtures wherever appropriate
* `typing` - take care of tests typing

### Example results
For the query given in usage example, this is what was generated:

```python
import pytest
from typing import List, Optional

def remove_empty(sequence: List[Optional[T]]) -> List[T]:
    """Function is meant to remove None values from sequence
    and return filtered sequence as list in the original order
    """
    filtered_sequence = [item for item in sequence if item is not None]
    return filtered_sequence


# ---------------------------------------------------
# Tests below

# Empty list given
def test_remove_empty_empty_list():
    """GIVEN empty list 
    WHEN function is called 
    THEN empty list is return
    """
    # Arrange
    input_sequence: List[Optional[int]] = []
    expected_output: List[int] = []
    
    # Act
    actual_output: List[int] = remove_empty(input_sequence)

    # Assert
    assert expected_output == actual_output


# Non empty list with only empty values given
def test_remove_empty_only_empty_values():
    """GIVEN list with only None values 
    WHEN function is called 
    THEN empty list is returned
    """
    # Arrange 
    input_sequence: List[Optional[int]] = [None, None]
    expected_output: List[int] = []
    
    # Act
    actual_output: List[int] = remove_empty(input_sequence)

    # Assert
    assert expected_output == actual_output


# Non empty list with both empty and non empty values given
def test_remove_empty_both_values():
    """GIVEN list with both None and int values 
    WHEN function is called 
    THEN filtered list is returned
    """
    # Arrange
    input_sequence: List[Optional[int]] = [1, None, 3]
    expected_output: List[int] = [1, 3]

    # Act
    actual_output: List[int] = remove_empty(input_sequence)

    # Assert
    assert expected_output == actual_output


# Non empty list with only non empty values given
def test_remove_empty_only_non_empty():
    """GIVEN list with only int values 
    WHEN function is called 
    THEN same list is returned
    """
    # Arrange
    input_sequence: List[Optional[int]] = [1, 2, 3]
    expected_output: List[int] = [1, 2, 3]

    # Act
    actual_output: List[int] = remove_empty(input_sequence)

    # Assert
    assert expected_output == actual_output
```
